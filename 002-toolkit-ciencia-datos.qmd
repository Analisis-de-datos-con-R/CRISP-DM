#  **R** toolkit para la ciencia de datos {#toolkit}

:::{.callout-warning}
### Objetivos {-}

- Instalar el software **R** y su IDE (Entorno de Desarrollo Integrado) **RStudio**.

- Informes reproducibles con **`quarto`** y control de versiones con **`GitHub`**.

- Conocer los fundamentos del modelo **CRISP-DM**.

:::


## R y RStudio

### Instalaci贸n de R y RStudio {#instal-r-rstudio}

**R** es un entorno de software libre para la computaci贸n estad铆stica y
los gr谩ficos. Se compila y ejecuta en una amplia variedad de plataformas
UNIX, Windows y MacOS. Las fuentes, los binarios y la documentaci贸n de R
pueden obtenerse a trav茅s de CRAN[^rstudio-1]. Para descargar **R** elija
su espejo CRAN preferido en
[www.r-project.org](https://www.r-project.org/).

[^rstudio-1]: La "Comprehensive R Archive Network" (CRAN) es una
    colecci贸n de sitios que contienen material id茅ntico, consistente en
    la(s) distribuci贸n(es) de R, las extensiones aportadas, la
    documentaci贸n para R y los binarios. El sitio principal de CRAN en
    la WU (Wirtschaftsuniversit盲t Wien) en Austria puede encontrarse en
    la URL <https://CRAN.R-project.org/> y se refleja diariamente en
    muchos sitios de todo el mundo.

**RStudio** es un entorno de desarrollo integrado (IDE) para **R**. Incluye
una consola, un editor que resalta la sintaxis y admite la ejecuci贸n
directa del c贸digo, as铆 como herramientas para el trazado, el historial,
la depuraci贸n y la gesti贸n del espacio de trabajo. RStudio est谩 disponible en ediciones comerciales y de c贸digo abierto y
se ejecuta en el escritorio (Windows, Mac y Linux) o en un navegador
conectado a RStudio Server o RStudio Workbench (Debian/Ubuntu, Red
Hat/CentOS y SUSE Linux), est谩 disponible en
[www.rstudio.com](https://www.rstudio.com/).


:::{.callout-note}
El orden es importante:

1. Instale **R**.

2. Instale **RStudio**.
:::


Compruebe que tiene instalados los iconos de la @fig-002-panrstudio2 y abra RStudio.


```{r , echo=FALSE, out.width='60%', fig.align='center', fig.cap='Iconos de R y RStudio'}
#| label: fig-002-panrstudio2
knitr::include_graphics("img/02-open-rstudio.png")
```





### Interfaz de RStudio 

Al abrir el programa se observan cuatro paneles (v茅ase @fig-002-panrstudio).

-  **Sripts**: para escribir c贸digo. 

- **Consola**: contiene la Consola, Terminal y los Jobs.

- **Entorno**: contiene el *Environment*, *History*, *conexiones* y *Git*, entre otros.

- **Files, Plots, Packages, Help y Viewer**

La posici贸n de los paneles se puede personalizar al gusto del
usuario, al igual que la apariencia del IDE.

```{r , echo=FALSE, out.width='80%', fig.align='center', fig.cap='Paneles de RStudio'}
#| label: fig-002-panrstudio
knitr::include_graphics(here::here("img/02-rstudio-layout.png"))
```


:::{.callout-note}
La posici贸n relativa y el contenido de cada panel pueden personalizarse
desde el men煤: Tools \> Global Options \> Pane Layout
:::


### Instalaci贸n los paquetes

Los paquetes son adiciones modulares al software **R** que a帽aden
funcionalidad en forma de nuevas funciones, conjuntos de datos,
 documentaci贸n, etc. El repositorio est谩ndar de paquetes **R** es
"Comprehensive R Archive Network" (CRAN). 

:::{.callout-note}
[**CRAN Task Views**](https://cran.r-project.org/web/views/):

Ofrecen un breve resumen de los paquetes incluidos. 
:::


Los paquetes se instalan con la funci贸n base de **R** `install.packages()`: 
```{r , eval=FALSE}
install.packages("tidyverse")
```

:::{.callout-note}
Los paquetes se instalan una 煤nica vez y se leen cada vez que se utilizan.
:::

Alternativamente, se pueden instalar desde el panel de Paquetes en RStudio desde una interfaz gr谩fica.






### Proyectos


Ser organizado desde el principio es uno de los mejores h谩bitos y en **R** esto se consigue trabajando con proyectos.
Un proyecto de **R** agrupa todo los ficheros del trabajo en una carpeta de forma que
se facilita su manejo, el trabajo colaborativo y su reproducibilidad.


:::{.callout-note}
*Crear un proyecto Quarto en R:*

Desde el men煤: File \> New Project y luego elija:

-   `Nuevo Directorio`

-   `Proyecto Vac铆o`

-   Elija un nombre para el directorio, por ejemplo, `mi_proyecto`

-   Haga clic en `Crear Proyecto`.
:::



- `r emo::ji("folder")` **data**: para los datos.

- `r emo::ji("folder")` **img**: para las im谩genes.

- `r emo::ji("folder")` **src**: contiene los *scripts* de **R** para llevar a cabo las
distintas tareas del an谩lisis.

-  `r emo::ji("folder")` **output**: se guardar谩n los resultados
finales de nuestro an谩lisis.

-  **README.md** debe contener
la informaci贸n b谩sica sobre el proyecto, la compatibilidad, los *inputs*
que necesita, los *outputs* que genera y un resumen de flujo del trabajo.
sto ayudar谩 a cualquiera a comprender mejor c贸mo es nuestro proyecto.

Una de las estructuras m谩s comunes es la mostrada en la @fig-proyecto:

```{r , echo=FALSE, fig.align='center'}
#| label: fig-proyecto
#| fig-cap: Ejemplo de estructura de un proyecto en R.
knitr::include_graphics(here::here("img/02-estructura_proyecto.png"))
```


:::{.callout-note}
Los distintos scripts se pueden ejecutar desde otros scripts.
Para ello se utiliza la funci贸n `source()`
:::

### Trabajar con un *script* de R 

Para comenzar a escribir un *script* nuevo nos dirigimos a File \> New
File. Los m谩s utilizados actualmente son:

+ `r emo::ji("notebook")` \> R Script. 

+ `r emo::ji("book")` \> Quarto document. 

+ `r emo::ji("notebook")` \> R Notebook.

+ `r emo::ji("document")` \> R Markdown.



:::{.callout-note}
Si se tiene creado un proyecto Quarto mejor trabajar con un un `quarto document` para luego renderizar todo el documento.
V茅ase @wickham2016r para un estudio profundo de proyectos.
:::

El editor es un editor de texto plano (sin negritas ni cursivas) pero
ofrece un c贸digo de colores del texto dependiendo de lo que se escriba
(resaltado de sintaxis).

Es extremadamente 煤til comentar el *script* con
informaci贸n adicional para hacer m谩s claro el proceso de programaci贸n. Para a帽adir un
comentario, simplemente hay que poner `#` al comienzo de la linea y lo
que est茅 a la derecha no ser谩 ejecutado.



Finalmente, a la hora de escribir c贸digo en **R** lo m谩s conveniente es usar las
buenas pr谩cticas dise帽adas por programadores expertos. Para ello, lo
mejor es aplicar una gu铆a de estilo `r emo::ji("book")`, cuyo objetivo es hacer que nuestro
c贸digo **R** sea m谩s f谩cil de leer, compartir y verificar. Una de las
mejores gu铆as es [The tidyverse style
guide](https://style.tidyverse.org/index.html).




## El ecosistema `tidyverse` {#tidy}

```{r tidy-logo, echo=FALSE, out.width='20%'}
knitr::include_graphics(here::here("img/02-logo-tityverse.png"))

```


El [tidyverse](https://www.tidyverse.org/) es una colecci贸n de **paquetes de R para la ciencia de los datos**. Todos los paquetes comparten una filosof铆a de dise帽o, una gram谩tica y unas estructuras de datos subyacentes. Se basan en la idea *tidy* data propuesta por Hadley Wickham (Wickham et al. 2014) y pueden instalarse con una 煤nica orden en **R**:

```{r , eval=FALSE}
install.packages("tidyverse")
```

Una vez instalado, se cargan con la funci贸n `library`:

```{r , message=FALSE, warning=FALSE}
library(tidyverse)
```


Los paqu茅tes m谩s importantes en ciencia de datos se enumeran a continuaci贸n.




```{r readr-logo, echo=FALSE, out.width='15%', fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-readr.png"))

```


### `readr` 


El paquete `readr` roporciona una forma r谩pida y amigable de leer datos 
rectangulares (como csv, tsv y fwf). Est谩 dise帽ado para 
analizar de forma flexible muchos tipos de datos que se encuentran en la naturaleza, mientras que sigue fallando limpiamente cuando los datos cambian inesperadamente.

`readr` admite los siguientes formatos de archivo asociados a estas funciones `read_*()`:

-  **`read_csv()`**: valores separados por coma, ficheros (CSV).

-  **`read_tsv()`**: valores separados por tabulador, fichero (TSV).

-  **`read_delim()`**: fichro delimitados (CSV y TSV son casos especiales).

-  **`read_fwf()`**: archivos de ancho fijo.

-  **`read_table()`**: archivos separados por espacios en blanco

-  **`read_log()`**: archivos de logos web.


:::{.callout-exm}

Lea la base de datos de calidad del aire de la ciudad de Madrid , `air_mad.RDS`, 
contenida en la carpeta `data`.
:::


(TODO): QUITAR LA FUNCIN HERE PORQUE A ESTE NIVEL SI NO SE EXPLICA PUEDE LIAR

```{r}
air_mad <- readr::read_rds("data/air_mad.RDS")
```





```{r dplyr-logo, echo=FALSE, out.width='15%',  fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-dplyr.png"))
```


### `dplyr`


El paquete [`dplyr`](https://dplyr.tidyverse.org/articles/dplyr.html) 
Ofrece una gram谩tica de la manipulaci贸n de datos, proporcionando 
un conjunto coherente de verbos que resuelven los problemas 
m谩s comunes de manipulaci贸n de datos y que pueden ser organizado 
tres categor铆as basado en el dataset:

1. **Filas:**

-  **`filter()`**: elige filas en funci贸n de los valores de la columna.

- **`slice()`**: elige filas en funci贸n de la ubicaci贸n.

- **`arrange()`**: cambia el orden de las filas.


2. **Columnas:**

- **`select()`**: indica cuando una columa es incluida o no.

- **`rename()`**: cambia el nombre de la columna.

- **`mutate()`**: cambia los valores de las columnas y crea nuevas columnas.

- **`relocate()`**: cambia el orden de las columnas.


3. **Grupos de filas:**

- **`summarise()`**: contrae un grupo en una sola fila.


:::{.callout-note}
### El operador pipe {-}

Canaliza la salida de una funci贸n a la entrada de otra funci贸n. 
```{r eval=FALSE}
segundo(primero(datos))
```

se traduce en:
```{r eval=FALSE}
datos %>% 
  primero %>% 
  segundo
```


**Operador pipe de \{maggrit\}** `%>%`
**Operador pipe de R base** `|>`
:::


:::{.callout-tip}
### Ejemplo. Medidas de posici贸n por estaci贸n de monitoreo

Calcule las medidas de posici贸n (m铆nimo, m谩ximo, Q1, Q3, media y mediana)
por estaci贸n de monitoreo , agrupando 
por `id_name` para Part铆culas \< 2.5 碌m `nom_abv == "PM2.5"` utilizando las funciones de la libreria `dplyr`.
:::


```{r}
air_mad %>% # Summary por grupo usando dplyr 
  na.omit() %>% # omitimos los NAs para el an谩lisis
  filter(V == "V" & nom_abv == "PM2.5") %>% # filtramos por PM2.5
  group_by(id_name) %>% 
  summarize(min = min(valor),
            q1 = quantile(valor, 0.25),
            median = median(valor),
            mean = mean(valor),
            q3 = quantile(valor, 0.75),
            max = max(valor))

```







```{r  tidyr-logo, echo=FALSE, out.width='15%',  fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-tidyr.png"))
```


### `tidyr`

El paquete `tidyr` proporciona un conjunto de funciones que le ayudan a 
obtener datos ordenados. Los datos ordenados son datos con una forma consistente. En resumen, cada variable va en una columna, y cada columna es una variable.

Las funciones se agrupan en 5 grandes categor铆as:

1. **Pivotar**. Convierte entre formas largas y anchas, `pivot_longer()` y `pivot_wider()` 

2. **Rectangling**. Convierte listas profundamente anidadas (a partir de JSON) en `tibbles` ordenados: `unnest_longer()`, `unnest_wider()`, `hoist()`.

3. **Anidar**. Convierte los datos agrupados en una forma en el que cada grupo se convierte en una sola fila que contiene un data frame anidado `nest()` y viceversa, `unnest()`.

4. **Dividir y combinar columnas de caracteres**. Funciones: `separate()`, `extract()` y `unite()`

5. **Valores perdidos**. Funciones: `complete()`, `drop_na()`, `fill()`, `replace_na()`




:::{.callout-tip}
### Ejemplo. 驴Cu谩l es el d铆a con mayor y menor concentraci贸n de NOx de todo el periodo?
:::

```{r}
air_mad %>% # Summary por grupo usando dplyr 
  na.omit() %>% # omitimos los NAs para el an谩lisis
  filter(V == "V" & nom_abv == "NOx") %>% # filtramos por NOx
  group_by(fecha) %>% # agrupamos por fecha
  summarize(mad_mean = mean(valor)) %>% # promedio de las estaciones
  slice(which.max(mad_mean), which.min(mad_mean)) #seleccionamos el m谩ximo y el m铆nimo 
```

El valor m谩ximo, **415 碌g/m3 de NOx**, se observa el 21 de diciembre de 2011 y el valor m铆nimo, **6,32 碌g/m3 de NOx**, el 10 de mayo de 2020, en pleno estado de alarma.






```{r ggplot2-logo, echo=FALSE, out.width='15%',  fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-ggplot2.png"))

```


### `ggplot2` 


El paquete `ggplot2` es un sistema para crear gr谩ficos de forma ordenada, 
basado en *The Grammar of Graphics*. Al proporcionar los datos, 
le dice a ggplot2 c贸mo asignar a las variables la est茅tica y
qu茅 gr谩ficas utilizar.

El template b谩sico para la funci贸n `ggplot()` es:
```{r , eval=FALSE}
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```



Los argumentos m谩s importantes para la representaci贸n de gr谩ficos son:

* `ggplot()`, crea un nuevo gr谩fico.

* `aes()`, construye la est茅tica el gr谩fico.

* `+(<gg>)`, a帽ade componentes al gr谩fico.

* `ggsave()`, guarda el gr谩fico.



:::{.callout-tip}
### Ejemplo. Gr谩fico de viol铆n.

Represente, con un gr谩fico de viol铆n, las concentraciones de NOx por a帽o en
el periodo estudiado.
:::



Una buena forma de ver los datos es por medio de un gr谩fico de viol铆n:

```{r, message=FALSE}

air_mad %>% # Summary por grupo usando dplyr 
  na.omit() %>% # omitimos los NAs para el an谩lisis
  filter(V == "V" & nom_abv == "NOx") %>% # filtramos por NOx
  group_by(year = format(fecha, "%Y")) %>% 
  summarise(valor)  %>% 
  ggplot(aes(factor(year), valor))+
  geom_violin() +
  geom_jitter(height = 0, width = 0.01) +
  aes(x=factor(year), y=valor, fill=year)


```




:::{.callout-note}

Libro de referencia obligatoria: [**ggplot2: elegant graphics for data analysis**](https://ggplot2-book.org/index.html). 

Es interesante conocer las [**Extensiones de ggplot2**](https://exts.ggplot2.tidyverse.org/gallery/)
as铆 como las [**ggplot2 Cheat sheet**](https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf) disponible.
:::









```{r purrr-logo, echo=FALSE, out.width='15%',  fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-purrr.png"))

```

### `purrr`

El paquete `purrr` mejora el conjunto de herramientas de programaci贸n 
funcional (PF) de R proporcionando un conjunto completo y coherente de herramientas para 
trabajar con funciones y vectores. Una vez que se dominan los conceptos b谩sicos, `purrr` 
permite sustituir muchos bucles `for` por un c贸digo m谩s f谩cil de escribir 
y m谩s expresivo.

:::{.callout-note}

Consulte la [**purrr Cheat sheet**](https://github.com/rstudio/cheatsheets/blob/main/purrr.pdf) disponible para una descripcion de la librer铆a.
:::






```{r tibble-logo, echo=FALSE, out.width='15%',  fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-tibble.png"))

```


### `tibble` 

El paquete `tibble` es una reimaginaci贸n moderna del marco de datos, 
manteniendo lo que el tiempo ha demostrado que es eficaz, y desechando 
lo que no. Los Tibbles suelen conducir a un c贸digo m谩s limpio y expresivo.


:::{.callout-tip}

Consulte el cap铆tulo 10 de [**R for data science**](https://es.r4ds.hadley.nz/tibbles.html) disponible 
online para una primera aproximaci贸n.
:::




```{r stringr-logo, echo=FALSE, out.width='10%',  fig.align='left'}
knitr::include_graphics(here::here("img/02-logo-stringr.png"))

```



### `stringr`


El paquete `stringr` proporciona un conjunto cohesivo de funciones dise帽adas 
para facilitar al m谩ximo el trabajo con cadenas. 


:::{.callout-tip}

Consulte el cap铆tulo 14 de [**R for data science**](https://es.r4ds.hadley.nz/cadenas-de-caracteres.html) disponible 
online para una primera aproximaci贸n.
:::







```{r forcats-logo, echo=FALSE, out.width='15%'}
knitr::include_graphics(here::here("img/02-logo-forcats.png"))

```

### `forcats` 


El paquete `forcats` proporciona un conjunto de herramientas 煤tiles que resuelven problemas comunes con los factores. R utiliza factores para manejar variables categ贸ricas, variables que tienen un conjunto fijo y conocido de valores posibles.


:::{.callout-note}

Consulte el cap铆tulo 14 de [**R for data science**](https://es.r4ds.hadley.nz/factores.html) disponible online para una primera aproximaci贸n.
:::



## Informes reproducibles con Quarto/Rmarkdown {#quarto} 

Este es un documento **R Quarto**. Quarto es una sintaxis simple de formato para la creaci贸n de documentos HTML, PDF y MS Word. Para obtener m谩s detalles sobre c贸mo usar R Quarto consulta <https://quarto.org/>.

RMarkdown (el antecesor de Quarto) y Quarto son herramientas permiten combinar texto formateado con c贸digo y resultados en un mismo documento. Quarto facilita la interoperabilidad entre **R**, **Python**, **Julia**.

Los documentos Quarto constan principalmetne de 3 partes:
+ el YAML (o cabecera del documento), 

+ el texto (cuerpo escrito del documento),

+ las chunks (tozos de c贸digo, en este caso, c贸digo **R**)


A continuaci贸n se exponen, brevemente, las principales ideas para entender y trabajar sintaxis `quarto`.

### Introducci贸n

#### Markdown: un lenguaje de marcado ligero

Markdown es un lenguaje de marcado ligero y f谩cil de aprender que permite dar formato al texto de manera sencilla. Con *Markdown*, es posible aplicar negrita, cursiva, encabezados, listas y enlaces, entre otras opciones de formato, simplemente utilizando una sintaxis intuitiva. La facilidad de uso del lenguaje *Markdown* hace que sea ampliamente utilizado, sobre todo para la documentaci贸n.

#### Integraci贸n de c贸digo y resultados
Una de las caracter铆sticas principales de Quarto/Rmarkdown es la capacidad de integrar c贸digo en el informe. Esto significa que se pueden incluir bloques de c贸digo o *chunks* en lenguajes como R, Python o Julia directamente en el documento. Estos bloques de c贸digo se ejecutan en tiempo real y los resultados, como tablas o gr谩ficos, se incrustan autom谩ticamente en el informe. Esto permite a los lectores ver tanto el c贸digo como los resultados generados, lo que promueve la transparencia y la reproducibilidad.

#### Generaci贸n de m煤ltiples formatos de salida
Quarto ofrece la posibilidad de generar informes en diferentes formatos de salida, como por ejemplo: HTML, PDF, Word o presentaciones de diapositivas. Esto es especialmente 煤til cuando se necesita compartir el informe con diferentes audiencias o cuando se requiere una presentaci贸n visualmente atractiva. La conversi贸n entre formatos se realiza de manera autom谩tica y se puede personalizar para que se adapte a las necesidades espec铆ficas de cada proyecto.

#### Facilidad de uso y colaboraci贸n
Quarto se integra con RStudio, lo que proporciona una experiencia de usuario fluida y amigable. Adem谩s, los archivos Rmarkdown son archivos de texto plano, lo que hace que sean f谩ciles para el control de versiones como Git. Esto facilita el trabajo en equipo y la colaboraci贸n en proyectos.

:::{.callout-tip}
La mayor铆a de los paquetes tiene una amplia documentaci贸n y los llamados *Cheatsheets* (chuletas). Son un buen m茅todo para ampliar los conocimientos. Algunas de ellas son:
 - Documentaci贸n de [Quarto](https://quarto.org/docs/authoring/markdown-basics.html#callout-blocks)
 - *Cheatsheet* de [RMarkdown](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf)
 - Colecci贸n de otros *cheatsheets* de [RStudio](https://posit.co/resources/cheatsheets/)
:::

### Instalaci贸n

Para poder utilizar Quarto/Rmarkdown en R y RStudio, es necesario realizar algunos pasos de instalaci贸n. A continuaci贸n, se detallan los pasos necesarios:

  1. Instalar R (v茅ase @instal-r-rstudio).
  2. Instalar RStudio (v茅ase @instal-r-rstudio).
  3. Intalar Quarto: para ello hay que dirigirse a la p谩gina oficial de [Quarto](https://quarto.org/), acceder al apartado [Get Started](https://quarto.org/docs/get-started/) y seleccionar la instalaci贸n acorde al sistema operativo. POsteriormente hay que seguir los pasos del instalador. 
  4. Instalar el paquete Quarto: Una vez que R, RStudio y Quarto, se debe instalar la librer铆a de Quarto para habilitar la funcionalidad de Quarto en R y RStudio. Para ello, se puede ejecutar el siguiente comando en la consola de RStudio:
  `install.packages("quarto")`
  
Despu茅s de la instalaci贸n, se debe configurar RStudio para utilizar Quarto como el motor de renderizado de Rmarkdown. Para ello, se debe abrir la pesta帽a *Tools* (Herramientas) en la barra de men煤 de RStudio y seleccionar *Global Options* (Opciones globales). En la ventana emergente, selecciona la pesta帽a *R Markdown* y aseg煤rate de que la opci贸n *Quarto* est茅 seleccionada en la secci贸n *Render*.

Con estos pasos completados, ya se puede comenzar a utilizar Quarto en RStudio para crear informes reproducibles. Se puede crear un nuevo archivo Rmarkdown y comenzar a combinar texto y c贸digo en un solo documento.


### El YAML

La sintaxis b谩sica de YAML utiliza pares clave-valor en el formato `clave: valor`. Otros campos YAML com煤nmente encontrados en los encabezados de los documentos incluyen metadatos como `author` (autor), `subtitle` (subt铆tulo), `date` (fecha), as铆 como opciones de personalizaci贸n como `theme` (tema), `fontcolor` (color de la fuente), `fig-width` (ancho de la figura), etc. Se puede encontrar informaci贸n sobre todos los campos YAML disponibles para documentos HTML en la p谩gina oficial de [Quarto](https://quarto.org/docs/reference/formats/html.html). Los campos YAML disponibles var铆an seg煤n el formato del documento, por ejemplo,los campos YAML para documentos [PDF](https://quarto.org/docs/reference/formats/pdf.html) y para [MS Word](https://quarto.org/docs/reference/formats/docx.html).

````
---
title: "My Document"
author:
    - Gema Fern谩ndez-Avil茅s
    - Michal Kinel
format: 
  html:
    toc: true
    code-fold: true
---

````

### Flujo de trabajo y el concepto renderizar

Un informe en Quarto/Rmarkdown se compone de bloques de texto y bloques de c贸digo. El texto se escribe en formato Markdown. Los bloques de c贸digo, *chunks* se delimitan con etiquetas especiales y pueden contener c贸digo en R, Python u otros lenguajes compatibles.

:::{.callout-note}
**renderizar** en RMarkdown/Quarto se refiere al proceso de transformar un documento escrito en lenguaje Markdown, que combina texto y c贸digo, en un formato final legible y presentable, como un informe, un documento PDF o una p谩gina web interactiva.

El proceso de renderizado se realiza mediante la ejecuci贸n de un motor de renderizado, como Quarto, que interpreta el documento RMarkdown y produce el resultado final en el formato deseado, como un archivo HTML, PDF, Word, entre otros. Durante el proceso de renderizado, el motor ejecuta el c贸digo R, genera los gr谩ficos y tablas correspondientes, y aplica el formato y estilo definidos en el documento.
:::

La mejor manera de tejer un `html_document` es mediante el bot贸n `Render` o la funci贸n `quarto::quarto_render()`.

```{r rmark-0, echo=FALSE, out.width='60%', fig.align='center', fig.cap='Diagrama de transformaci贸n de un documento Quarto a HTML, PDF, etc.'}

knitr::include_graphics(here::here("img/02-quarto.png"))
```


#### Trozos de c贸digo *chunks*

Los bloques de c贸digo en Quarto/Rmarkdown se utilizan para incorporar c贸digo fuente en el informe. Estos bloques se delimitan mediante etiquetas especiales, como `{r}` para c贸digo en R o `{python}` para c贸digo en Python. Dentro de estos bloques, se puede escribir y ejecutar c贸digo de la misma manera que se har铆a en un entorno de programaci贸n normal.

La ejecuci贸n del c贸digo se realiza en tiempo real, lo que significa que los resultados generados, como tablas, gr谩ficos o textos formateados, se incrustan directamente en el informe cuando se renderiza. Esto permite a los lectores ver los resultados obtenidos y verificar la reproducibilidad del an谩lisis.

Se puede insertar r谩pidamente bloques de c贸digo con el comando Agregar Bloque en la barra de herramientas del editor o escribiendo los delimitadores de bloque: 


```{r} 
2+2
```



La salida de una chunk se puede personalizar con las opciones de knitr. Algunas de las m谩s usadas son:

-   `|# include: false` evita que el c贸digo y los resultados aparezcan en el archivo final. R Markdown sigue ejecutando el c贸digo en el chunk, y los resultados pueden ser utilizados por otros chunks.
-   `|# echo : false` evita que el c贸digo, pero no los resultados, aparezcan en el archivo final. Es una forma 煤til de incrustar cifras.
-   `|# message : false` evita que los mensajes generados por el c贸digo aparezcan en el archivo final.
-   `|# warning : false` evita que las advertencias generadas por el c贸digo aparezcan en el acabado.
-   `|# fig.cap : "..."` a帽ade una leyenda a los resultados gr谩ficos.

M谩s informaci贸n sobre la opci贸n de trozos de c贸digo: [Quarto chunks](https://quarto.org/docs/reference/cells/cells-knitr.html).

#### Formato de texto

El texto en formato Markdown se utiliza para proporcionar explicaciones, descripciones y contexto en el documento Escribir texto en Markdown es sencillo, ya que no requiere conocimientos avanzados de programaci贸n. Con Markdown, se pueden aplicar diferentes estilos de formato utilizando una sintaxis sencilla y legible. 

Se pueden a帽adir [enlaces](www.r-graph-gallery.com), escribir en **negrita** o *cursiva*. Consulta la hoja de trucos de Rstudio [descargar aqu铆](https://raw.githubusercontent.com/rstudio/cheatsheets/main/rmarkdown.pdf).

> Hacer citas

| bloque de l铆nea

**Otros formatos de texto:**

-   [subrayado]{.underline}
-   ~~tachar~~
-   ^super铆ndice^
-   ~sub铆ndice~
-   [versalitas]{.smallcaps}

La forma de a帽adir notas a pie de p谩gina es `[^number]`[^1]

[^1]: la nota a pie de p谩gina

Tambi茅n se puede a帽adir emojis incre铆bles como  insert谩ndolo en el editor visual markdown o mediante su c贸digo `:heart_eyes_cat:`.

------------------------------------------------------------------------

A veces es necesario separar el texto con una l铆nea horizontal, para ello simplemente se introduce `***`

<br><br><br><br>

o saltar una l铆nea con c贸digo html `<br><br><br><br>`.

#### A帽adir una imagen

Para a帽adir im谩genes basta con escribir `![image_name](image_path)`

![R learners. Cr茅ditos: Allison Horst](img/02-Rlearners.png)

Si desea centrar la imagen, un poco de c贸digo htm le ayudar谩, s贸lo tiene que utilizar `<center> </center>`

<center>

![R & RStudio](https://bookdown.org/oscar_teach/estadistica_aplicada_con_r/r-rstudio.png)

</center>

Para ajustar las im谩genes puedes usar **r chunk** a帽adiendo la imagen con una funci贸n `knitr::include_graphics`

```{r, fig.align='right', out.width='20%', fig.cap='Mi super foto'}
knitr::include_graphics("https://bookdown.org/oscar_teach/estadistica_aplicada_con_r/r-rstudio.png")
```



```{r}
#| label: fig-plots
#| fig-cap: "Plots" 
#| layout-ncol: 2
#| fig-subcap:
#|   - "Plot 1: eed and Stopping Distances of Cars"
#|   - "Plot 2: por Pressure of Mercury as a Function of Temperature"

plot(cars)
plot(pressure)



```

V茅anse ejemplos en @fig-plots. En particular, @fig-plots-2.

#### Ecuaciones

Insertar ecuaciones en un documento Quarteo es f谩cil utilizando la escritura Latex
+ en l铆nea: $A = (\pi * \lambda \times r^{4}) / \alpha$

+ centradas: $$A = (\pi * \lambda \times r^{4}) / \alpha$$


#### Diagramas

Quarto tiene soporte nativo para incrustar diagramas [Mermaid](https://mermaid-js.github.io/mermaid/#/) y [Graphviz](https://graphviz.org/). Esto te permite crear diagramas de flujo, diagramas de secuencia, diagramas de estado, diagramas gnatt, y m谩s usando una sintaxis de texto plano inspirada en markdown.

Por ejemplo, aqu铆 se incrusta un diagrama de flujo creado con Mermaid:

```{mermaid}
flowchart LR
  A[Hard edge] --> B(Round edge)
  B --> C{Decision}
  C --> D[Result one]
  C --> E[Result two]
```


Gantt diagram:

```{mermaid}
gantt
dateFormat  YYYY-MM-DD
title Adding GANTT diagram to mermaid
excludes weekdays 2014-01-10

section A section
Completed task            :done,    des1, 2014-01-06,2014-01-08
Active task               :active,  des2, 2014-01-09, 3d
Future task               :         des3, after des2, 5d
Future task2               :         des4, after des3, 5d

```

#### Bloques de llamada

:::{.callout-note}
Tenga en cuenta que hay cinco tipos de llamadas, incluyendo: 
`note`, `tip`, `warning`, `caution`, and `important`.
:::


#### Listas 

::: {layout-ncol=2}
- 铆tem X
- 铆tem Y
- 铆tem Z

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur gravida eu erat et fring. Morbi congue augue vel eros ullamcorper, eget convallis tortor sagittis. Fusce sodales viverra mauris a fringilla. Donec feugiat, justo eu blandit placerat, enim dui volutpat turpis, eu dictum lectus urna eu urna. Mauris sed massa ornare, interdum ipsum a, semper massa. 
:::


#### Ap茅ndice {.appendix}

Lorem ipsum dolor sit amet, consectetur adipiscing elit. 


#### Citaciones

R Markdown The Definitive Guide [@xie2018r]

### Renderizado

Utiliza el bot贸n de **Render** en el entorno de desarrollo integrado (IDE) de RStudio para renderizar el archivo y previsualizar el resultado con un solo clic o combinaci贸n de teclas (рK).

```{r, fig.align='center'}
knitr::include_graphics("img/rstudio-render.png")
```
Si se prefiere renderizar autom谩ticamente cada vez que se guarda el documento, se puede activar la opci贸n de Renderizar al Guardar (Render on Save) en la barra de herramientas del editor. La previsualizaci贸n se actualizar谩 cada vez que vuelvas a renderizar el documento. La vista de previsualizaci贸n en paralelo funciona tanto para salidas en HTML como en PDF.

## Buscar ayuda en **R** o sobre **R** (funciones, paquetes, errores)

Las funciones de distintos paquetes de R tienen su ayuda y es muy f谩cil
acceder a ella desde la consola poniendo un signo de interrogaci贸n
delante de la funci贸n, por ejemplo al ejecutar `?mean` en la consola se
abrir谩 la ventana de ***Help*** con la descripci贸n de la funci贸n, su
uso, los argumentos y otros datos relevantes que nos permitir谩n entender
mejor la funci贸n que ejecutamos. Tambi茅n, existe una amplia informaci贸n
online sobre las funciones y distintos paquetes disponible en
[Rdocumentation.org](https://rdocumentation.org/).

### Haz preguntas

Uno de los foros m谩s amplio de b煤squeda de preguntas y respuestas sobre
la programaci贸n es
[StackOverflow](https://stackoverflow.com/questions/tagged/r). En
StackOverflow se registraron hasta el momento m谩s 450.000 preguntas. Se
puede navegar por los archivos de StackOverflow y ver qu茅 respuestas han
sido votadas por los usuarios, o puedes hacer tus propias preguntas
relacionadas con R y esperar una respuesta.

<!-- ::: infobox -->
<!-- **C贸mo crear un ejemplo m铆nimo y reproducible** -->

<!-- Cuando se hace una pregunta, la gente ser谩 m谩s capaz de proporcionar ayuda si se -->
<!-- proporciona un c贸digo que puedan entender f谩cilmente y utilizar para -->
<!-- reproducir el problema. Los miembros de la comunidad se refieren a esto -->
<!-- como la creaci贸n de un ejemplo m铆nimo y reproducible (reprex), un -->
<!-- ejemplo m铆nimo, completo y verificable (mcve), o un ejemplo m铆nimo y -->
<!-- viable (mwe). Independientemente de c贸mo se le comunique, se reduce a -->
<!-- asegurar que su c贸digo que reproduce el problema sigue las siguientes -->
<!-- directrices: -->

<!-- Tus ejemplos de c贸digo deben ser... -->

<!-- -   M铆nimos - Utilizar la menor cantidad de c贸digo posible que siga -->
<!--     produciendo el mismo problema -->
<!-- -   Completos - Proporcionar todas las partes que alguien necesita para -->
<!--     reproducir su problema en la propia pregunta -->
<!-- -   Reproducible - Pruebe el c贸digo que va a proporcionar para -->
<!--     asegurarse de que reproduce el problema -->
<!-- ::: -->

<!-- Si tienes una pregunta m谩s relacionada con la metodolog铆a estad铆stica, -->
<!-- tambi茅n hay muchos usuarios de R activos en la comunidad de preguntas y -->
<!-- respuestas de [CrossValidated](https://stats.stackexchange.com/). -->

<!-- Adem谩s se puede pedir ayuda a los usuarios de R y RStudio en -->
<!-- [community.rstudio.com](https://community.rstudio.com/). -->

### Sigue la comunidad de R

Existen diversas p谩ginas web que contienen art铆culos sobre la
programaci贸n en R, como por ejemplo:

-   [R bloggers](https://www.r-bloggers.com/): un agregador de blogs que
    vuelve a publicar art铆culos relacionados con R de toda la web. Un
    buen lugar para encontrar tutoriales de R,

-   [RWeekly](https://rweekly.org/): R Weekly se fund贸 el 20 de mayo
    de 2016. R est谩 creciendo muy r谩pidamente, y hay un mont贸n de
    grandes blogs, tutoriales y otros formatos de recursos que salen
    cada d铆a. R Weekly quiere hacer un seguimiento de estas grandes
    cosas en la comunidad de R y hacerla m谩s accesible para todos.

-   [RPubs](https://rpubs.com/): RStudio permite aprovechar el poder de
    R Markdown para crear documentos que entrelazan su escritura y la
    salida de su c贸digo R. En RPubs se puede publicar esos documentos en
    la web en un click.

-   [Medium](https://medium.com/): un sitio web de blogs donde se puede
    encontrar mucha tem谩tica sobre el Data Science.

## Git y GitHub

驴Git y GitHub? En primer lugar, son dos cosas distintas:

-   **Git** es un software de c贸digo abierto para el control de
    versiones. Con Git puedes hacer cosas como ver todas las versiones
    anteriores del c贸digo que has creado en un proyecto.

-   **GitHub** es el servicio m谩s popular (otros son GitLab y BitBucket)
    para colaborar en el c贸digo utilizando Git.

### 驴Por qu茅 deber铆a usar Git y GitHub?

Las tres principales ventajas de utilizar Git y GitHub son:

1.  El uso de Git y GitHub sirve como copia de seguridad. Dado que
    GitHub tiene una copia de todo el c贸digo que tienes localmente, si
    algo le ocurriera a tu ordenador, seguir铆as teniendo acceso a tu
    c贸digo.

2.  El uso de Git y GitHub te permite utilizar el control de versiones.
    驴Alguna vez has tenido documentos llamados trabajo_final.pdf,
    trabajo_final_2.pdf o este_es_el_final.pdf? En lugar de hacer copias
    de los archivos por miedo a perder el trabajo, el control de
    versiones permite ver lo que se hizo en el pasado, todo ello
    manteniendo versiones 煤nicas de los documentos.

3.  El uso de Git y GitHub hace posible trabajar en el mismo proyecto al
    mismo tiempo con distintos colaboradores. Se puede ver el autor de
    los cambios y se fuera necesario volver a la versi贸n anterior.

Para poner Git y GitHub a punto lo mejor es seguir la gu铆a de [Happy Git
and GitHub for the useR](https://happygitwithr.com/) en la que se
explica paso a paso como registrarse en GitHub e instalar Git, adem谩s de
integrarlo en RStuidio.


      
     